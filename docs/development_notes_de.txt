Projektziel
- Entwicklung eines stromsparenden Fahrrad-Computers auf ESP32-Basis mit Telemetrie, Anzeige und Diebstahlschutz.

Überblick
- Zustandsmaschine für klare Ablaufsteuerung (INIT, WIFI_CONNECTING, IDLE, ACTIVE, DISCONNECTED, DEEP_SLEEP, ERROR).
- Effiziente Kommunikation per CoAP/UDP; kompakte JSON-Payloads im NON-Modus.
- 16x2 I2C-LCD zur Anzeige von Uhrzeit, Umwelt- und Bewegungsdaten; einfache UI-Pages per Button.
- Energieoptimierung durch WiFi-Light-Sleep, adaptive Sensor- und Sendeintervalle.

Hardware
- ESP32 DevKit (Arduino-Framework).
- Sensoren: DHT22 (Temperatur/Luftfeuchte), MPU6050 (Beschleunigung/Gyro).
- Uhr: DS1302 RTC (Zeit für Anzeige/Logs; Set auf Build-Zeit beim Flashen).
- Anzeige: 16x2 I2C LCD (`LiquidCrystal_I2C`).
- LED: RGB-LED für Statusmeldungen (Rot/Blau/Grün, SOS-Pattern bei Diebstahl).
- Button: Seitenwechsel; konfigurierbar als Pull-up oder Pull-down.

Software & Bibliotheken
- PlatformIO-Projekt mit Arduino-Core.
- Bibliotheken: DHT_Unified, Adafruit_MPU6050, LiquidCrystal_I2C, RtcDS1302, CoAP-simple, WiFi/WiFiUDP.
- Projektstruktur: `src/` (Logik), `lib/` (ggf. Zusatz), `docs/` (Dokumentation), `test/` (Platzhalter).

Zustände & Logik
- INIT: Hardware-Init, erste Sensorchecks, WLAN-Start.
- WIFI_CONNECTING: Verbindungsaufbau, Statusanzeige Blau.
- IDLE: Verbunden, keine Bewegung; reduzierte Sensorfrequenz; Heartbeat alle 10 Minuten.
- ACTIVE: Verbunden, Bewegung erkannt; Sensoren häufiger; Telemetrie alle 2 Sekunden.
- DISCONNECTED: WLAN verloren; niedrige Aktivität; Reconnect-Versuch alle 10 Minuten.
- DEEP_SLEEP: Tiefschlaf (optional, abhängig von LED-Laufzeitpolitik und Use-Case).
- ERROR: Fehlerzustand mit zeitgesteuertem Neustart.

Sensorik
- DHT22: Gelesen mit `Config::DHT_READ_MS`-Throttling; Initialcheck im Setup (OK/FAILED).
- MPU6050: Bewegungsdetektion über Magnituden von Beschleunigung und Gyro; Schwellwerte konfigurierbar.
- Bewegung: `MOVEMENT_ACCEL_THRESHOLD`, `MOVEMENT_GYRO_THRESHOLD`; Timeout `MOVEMENT_TIMEOUT_MS`.
- Diebstahl: Höhere Schwellwerte (X/Y/Z, Gyro) aktivieren Alarm und priorisiertes LED-SOS.

Kommunikation (CoAP)
- Server-IP/Port konfigurierbar, Re-Init von CoAP nach WLAN-Reconnect.
- Senden:
	- Aktiv (Bewegung): alle 2 Sekunden.
	- Idle: Heartbeat alle 10 Minuten.
- CoAP-Loop gedrosselt, nur bei WLAN-Verbindung ausgeführt zur Fehlervermeidung.

Energie & Power-Management
- WiFi-Light-Sleep für Grundlastreduktion, Deaktivierung kurzzeitig vor Sendevorgängen.
- Adaptive Loop-Verzögerungen je Zustand (Active/Idle/Disconnected).
- Optional: Tiefschlaf nach längerer Inaktivität; LED-Laufzeit kann Tiefschlaf verhindern (Diebstahl-Fokus).

Anzeige & LED
- LCD-Pages:
	- Zeit/Datum (RTC).
	- Umwelt (Temperatur, Luftfeuchte + DHT-Status).
	- Bewegung (Accel/Gyro live).
	- Netzwerk/State (WiFi-Status, lokale IP).
- LED-Status:
	- INIT: Blau-Blink.
	- COAP_CONNECTING: Blau.
	- SYSTEM_OK: Grün.
	- COAP_ERROR: Rot.
	- THEFT_ALERT: Rot-SOS (3 kurz, 3 lang, 3 kurz).

Netzwerkdiagnostik
- WLAN-Scan vor Verbindungsaufbau; klare Statuslogs (z. B. `WL_NO_SSID_AVAIL`).
- Reconnect-Backoff: alle 10 Minuten; CoAP erst nach erfolgreichem WLAN-Connect starten.

Build & Deployment
- PlatformIO: Build, Upload, serielle Logs für Diagnose.
- RTC wird beim Flashen auf Build-Zeit gesetzt (aus `__DATE__`/`__TIME__`).

Fehlerbehebung (Troubleshooting)
- WLAN verbindet nicht: SSID im 2,4 GHz-Band, nicht verborgen; Gerät näher am AP; SSID exakt prüfen.
- DHT unzuverlässig: Stabilisierung (200 ms), Lese-Intervall erhöhen, Verkabelung/5V/3,3V und Pullup prüfen.
- Button reagiert nicht: Pull-up/-down-Config beachten, Rohwerte loggen, Verdrahtung kontrollieren.
- UDP-Fehler-Spam: CoAP-Loop nur bei WLAN-Verbindung ausführen.

Roadmap
- NTP-Zeitsync optional zusätzlich zur RTC.
- Exponentielles Backoff für Reconnect, konfigurierbar.
- Filterung/Glättung von DHT- und Bewegungsdaten.
- Optionales Telemetrie-Buffering bei Offline-Betrieb.

Hinweise
- APIs: Optional geplante Nutzung externer Wetter-/Zeit-Dienste; aktuell lokal über RTC.
- Zielkriterium: stabiles, energieeffizientes Laufverhalten (>1 h) mit verlässlicher Anzeige/Telemetrie.